<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Para Alguien Especial</title>
    <style>
        :root {
            --primary-pink: #ffafbd;
            --secondary-pink: #ffc3a0;
            --deep-red: #e91e63;
            --soft-white: #fff5f7;
            --shadow-3d: 0 20px 40px rgba(0,0,0,0.15), 0 10px 10px rgba(0,0,0,0.1);
            --transition-speed: 0.6s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: none; /* Prevents scrolling during the game */
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, var(--primary-pink), var(--secondary-pink));
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        #particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .app-container {
            position: relative;
            width: 90%;
            max-width: 450px;
            height: 550px;
            z-index: 10;
        }

        .screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 30px;
            box-shadow: var(--shadow-3d);
            transform-style: preserve-3d;
            transition: transform var(--transition-speed) cubic-bezier(0.4, 0, 0.2, 1), 
                        opacity var(--transition-speed) ease;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.4);
            overflow: hidden; /* Crucial to keep button inside visually */
        }

        .screen.hidden {
            opacity: 0;
            transform: rotateY(90deg) scale(0.8);
            pointer-events: none;
        }

        h1 {
            color: #d81b60;
            font-size: 1.8rem;
            margin-bottom: 20px;
            transform: translateZ(30px);
        }

        p {
            color: #880e4f;
            line-height: 1.6;
            font-size: 1.1rem;
            margin-bottom: 10px;
            transform: translateZ(20px);
        }

        .btn-container {
            display: flex;
            gap: 20px;
            margin-top: 40px;
            width: 100%;
            justify-content: center;
            align-items: center;
            min-height: 150px; /* Space for the "No" button to move */
            position: relative;
        }

        .btn {
            padding: 14px 34px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateZ(40px);
            z-index: 5;
        }

        .btn-yes {
            background: var(--deep-red);
            color: white;
        }

        .btn-no {
            background: #f0f0f0;
            color: #666;
            /* Transition is subtle for the "jump" effect */
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        #phrases-area {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .phrase-item {
            position: absolute;
            width: 90%;
            padding: 15px;
            font-style: italic;
            color: #d81b60;
            font-size: 1.3rem;
            opacity: 0;
            transition: opacity 800ms ease;
            text-shadow: 0 1px 1px rgba(0,0,0,0.05);
        }

        .phrase-item.active {
            opacity: 1;
        }

        .final-emoji {
            font-size: 4rem;
            margin-top: 20px;
            display: block;
        }

        @media (max-width: 400px) {
            h1 { font-size: 1.4rem; }
            .btn { padding: 12px 28px; }
        }
    </style>
</head>
<body>

    <canvas id="particles"></canvas>

    <div class="app-container">
        <!-- PANTALLA 1 -->
        <div id="screen-1" class="screen">
            <p>Se que ya diste una respuesta pero quiero preguntar de nuevo游뗶</p>
            <h1>쯈uieres ser mi novia?</h1>
            <div id="btn-wrapper" class="btn-container">
                <button id="yes-btn" class="btn btn-yes">S칤</button>
                <button id="no-btn" class="btn btn-no">No</button>
            </div>
        </div>

        <!-- PANTALLA 2 -->
        <div id="screen-2" class="screen hidden">
            <div id="phrases-area"></div>
        </div>

        <!-- PANTALLA 3 -->
        <div id="screen-3" class="screen hidden">
            <div id="final-message-container"></div>
        </div>
    </div>

    <script>
        const state = {
            currentScreen: 1,
            noAttempts: 0,
            choice: null,
            phraseIdx: 0
        };

        const phrases = [
            "A veces las mejores cosas llegan sin avisar, como t칰",
            "Me gusta c칩mo el mundo se siente m치s tranquilo cuando est치s cerca",
            "No busco perfecci칩n, busco alguien que haga que valga la pena el camino",
            "Contigo he aprendido que los peque침os detalles son los m치s grandes",
            "Tu risa es mi sonido favorito, sin importar el d칤a que tenga",
            "Admiro tu forma de ver la vida, incluso cuando todo parece gris",
            "No s칠 qu칠 nos depara el futuro, pero me encantar칤a descubrirlo a tu lado",
            "Gracias por ser ese refugio donde siempre es f치cil ser yo mismo",
            "Hay personas que son hogar, y t칰 definitivamente lo eres",
            "Me basta con saber que est치s, para que todo se sienta un poco mejor"
        ];

        const s1 = document.getElementById('screen-1');
        const s2 = document.getElementById('screen-2');
        const s3 = document.getElementById('screen-3');
        const noBtn = document.getElementById('no-btn');
        const yesBtn = document.getElementById('yes-btn');
        const phrasesArea = document.getElementById('phrases-area');
        const finalContent = document.getElementById('final-message-container');

        // Part칤culas de fondo
        const canvas = document.getElementById('particles');
        const ctx = canvas.getContext('2d');
        let hearts = [];

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        class Heart {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height + 20;
                this.size = Math.random() * 10 + 5;
                this.vel = Math.random() * 1.5 + 0.5;
                this.opacity = Math.random() * 0.5 + 0.2;
            }
            update() {
                this.y -= this.vel;
                if (this.y < -20) this.reset();
            }
            draw() {
                ctx.globalAlpha = this.opacity;
                ctx.fillStyle = '#ff4d6d';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        for(let i=0; i<40; i++) hearts.push(new Heart());
        function anim() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            hearts.forEach(h => { h.update(); h.draw(); });
            requestAnimationFrame(anim);
        }
        anim();

        // L칩gica del Bot칩n "No" (Movimiento interno)
        const moveNo = (e) => {
            if (e) e.preventDefault();
            state.noAttempts++;
            state.choice = 'no';

            if (state.noAttempts >= 4) {
                transitionTo(2);
                return;
            }

            // Calculamos l칤mites basados en el contenedor .screen
            const screenRect = s1.getBoundingClientRect();
            const btnRect = noBtn.getBoundingClientRect();

            // Definimos el 치rea segura (restando padding y tama침o del bot칩n)
            const padding = 40;
            const availableWidth = screenRect.width - btnRect.width - (padding * 2);
            const availableHeight = screenRect.height - btnRect.height - (padding * 2);

            // Generar posici칩n aleatoria relativa al contenedor screen
            const newX = Math.random() * availableWidth - (availableWidth / 2);
            const newY = Math.random() * availableHeight - (availableHeight / 2);

            // Aplicamos transformaci칩n para moverlo sin sacarlo del flujo o la vista
            noBtn.style.position = 'absolute';
            noBtn.style.transform = `translate(${newX}px, ${newY}px) translateZ(40px)`;
        };

        noBtn.addEventListener('mouseover', moveNo);
        noBtn.addEventListener('touchstart', moveNo);

        yesBtn.addEventListener('click', () => {
            state.choice = 'yes';
            transitionTo(2);
        });

        function transitionTo(screenIdx) {
            [s1, s2, s3].forEach((s, i) => {
                s.classList.toggle('hidden', i !== screenIdx - 1);
            });
            if (screenIdx === 2) runPhrases();
            if (screenIdx === 3) runFinal();
        }

        // Sistema de Frases
        async function runPhrases() {
            await showGroup([phrases[0]]);
            state.phraseIdx = 1;

            s2.addEventListener('click', async () => {
                if (state.phraseIdx >= phrases.length) {
                    transitionTo(3);
                    return;
                }
                const size = Math.floor(Math.random() * 3) + 1;
                const slice = phrases.slice(state.phraseIdx, state.phraseIdx + size);
                state.phraseIdx += size;
                await showGroup(slice);
            });
        }

        async function showGroup(list) {
            phrasesArea.innerHTML = "";
            for (const [i, text] of list.entries()) {
                const p = document.createElement('div');
                p.className = 'phrase-item';
                if (list.length > 1) {
                    p.style.top = `${25 + (i * 20)}%`;
                }
                phrasesArea.appendChild(p);
                p.classList.add('active');
                await type(p, text);
            }
        }

        function type(el, text) {
            return new Promise(res => {
                let i = 0;
                const t = setInterval(() => {
                    el.textContent += text[i];
                    i++;
                    if (i === text.length) { clearInterval(t); res(); }
                }, 50);
            });
        }

        function runFinal() {
            if (state.choice === 'yes') {
                finalContent.innerHTML = `<h1>춰Plan exitoso!</h1>
                <p>Fase 1: conseguir tu s칤. Fase 2: hacerte re칤r todos los d칤as. 쮸ceptas la misi칩n?  (Aunque probablementa ya te saqu칠 una sonrisa con esto jajaja)</p>`;
            } else {
                finalContent.innerHTML = `<h1>Lo entiendo...</h1>
                <p>Bueno, al menos consegu칤 que jugaras a atrapar el bot칩n. En serio, valoro demasiado nuestra amstad para dejarla ir. 쯉eguimos siendo amigos especiales?仇벒잺</p>`;
            }
        }

        // Efecto 3D sutil con el rat칩n
        document.addEventListener('mousemove', (e) => {
            const x = (window.innerWidth / 2 - e.clientX) / 20;
            const y = (window.innerHeight / 2 - e.clientY) / 20;
            const current = document.querySelector('.screen:not(.hidden)');
            if (current) current.style.transform = `rotateY(${-x}deg) rotateX(${y}deg)`;
        });

    </script>
</body>
</html>

